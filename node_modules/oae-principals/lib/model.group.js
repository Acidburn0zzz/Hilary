/*!
 * Copyright 2012 Sakai Foundation (SF) Licensed under the
 * Educational Community License, Version 2.0 (the "License"); you may
 * not use this file except in compliance with the License. You may
 * obtain a copy of the License at
 * 
 *     http://www.osedu.org/licenses/ECL-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

var Signature = require('oae-util/lib/signature');

/**
 * The Group model
 *
 * @param  {String}     tenant                  The tenant this group belongs to.
 * @param  {String}     id                      The globally unique principalId for this group. ie: g:cam:math-101
 * @param  {String}     alias                   The alias of this group
 * @param  {String}     [opts]                  Optional additional group properties
 * @param  {String}     [opts.visibility]       The visibility of this group. ie: loggedin
 * @param  {String}     [opts.joinable]         How this group can be joined
 * @param  {String}     [opts.name]             The name of the group
 * @param  {String}     [opts.description]      The description of the group
 * @param  {Boolean}    [opts.smallPictureUri]  The URI of the small picture
 * @param  {Boolean}    [opts.mediumPictureUri] The URI of the medium picture
 * @param  {Boolean}    [opts.largePictureUri]  The URI of the large picture
 */
module.exports.Group = function(tenant, id, alias, opts) {
    opts = opts || {};

    var that = {};
    that.id = id;
    that.alias = alias;
    that.tenant = tenant;
    that.visibility = opts.visibility;
    that.joinable = opts.joinable;
    that.name = opts.name;
    that.description = opts.description;

    if (opts.smallPictureUri) {
        that.smallPicture = '/api/download/signed?uri=' + opts.smallPictureUri + '&signature=' + Signature.sign(opts.smallPictureUri);
        that.smallPictureUri = opts.smallPictureUri;
    }
    if (opts.mediumPictureUri) {
        that.mediumPicture = '/api/download/signed?uri=' + opts.mediumPictureUri + '&signature=' + Signature.sign(opts.mediumPictureUri);
        that.mediumPictureUri = opts.mediumPictureUri;
    }
    if (opts.largePictureUri) {
        that.largePicture = '/api/download/signed?uri=' + opts.largePictureUri + '&signature=' + Signature.sign(opts.largePictureUri);
        that.largePictureUri = opts.largePictureUri;
    }

    return that;
};
