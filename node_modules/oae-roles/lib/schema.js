var _ = require('underscore');

var Cassandra = require('oae-util/lib/cassandra');

/**
 * Ensures that the Role schema is active. If it has already been created, this will have no effect.
 *
 * @param {Function} callback A function(err) that specifies whether or not the operation was successful
 */
module.exports.ensureSchema = function(callback) {
    Cassandra.createColumnFamilyIfNotExists('Role', 'create columnfamily Role (principal text primary key)', function (err) {
        if (_.isFunction(callback)) {
            callback(err);
        } else if (err) {
            throw err;
        }
    });
};

/**
 * Drop the roles schema, and all its associated data.
 * 
 * @param {Function} callback A function(err) that specifies whether or not the operation was successful
 */
module.exports.dropSchema = function(callback) {
    Cassandra.dropColumnFamily('Role', function(err) {
        if (_.isFunction(callback)) {
            callback(err);
        } else if (err) {
            throw err;
        }
    });
}